<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸¬è©¦è‡ªå‹•æª¢æ¸¬é‚è¼¯</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #1e293b;
            color: #e2e8f0;
        }
        .test-case {
            background-color: #334155;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid #475569;
        }
        .test-case.incomplete {
            border-color: #f59e0b;
            background-color: #7c2d12;
        }
        .test-case.complete {
            border-color: #10b981;
            background-color: #065f46;
        }
        .title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #3b82f6;
        }
        .code {
            background-color: #1e293b;
            padding: 8px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
        }
        button {
            background-color: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px;
        }
        button:hover {
            background-color: #2563eb;
        }
    </style>
</head>
<body>
    <h1>ğŸ” æ¸¬è©¦è‡ªå‹•æª¢æ¸¬é‚è¼¯</h1>
    
    <button onclick="testDetectionLogic()">ğŸš€ æ¸¬è©¦æª¢æ¸¬é‚è¼¯</button>
    <button onclick="clearResults()">ğŸ§¹ æ¸…é™¤çµæœ</button>
    
    <div id="results"></div>

    <script>
        // æ¨¡æ“¬æª¢æ¸¬é‚è¼¯
        function isIncompleteStock(symbol, stockData) {
            return !stockData || 
                   !stockData.currentPrice || 
                   stockData.currentPrice <= 0 || 
                   stockData.name === symbol ||
                   stockData.name.includes('è‡ªè¨‚') ||
                   stockData.name.includes('è‚¡ç¥¨');
        }

        window.testDetectionLogic = () => {
            const resultsDiv = document.getElementById('results');
            
            // æ¸¬è©¦æ¡ˆä¾‹
            const testCases = [
                {
                    symbol: '006208',
                    stockData: {
                        name: 'å¯Œé‚¦å°50',
                        currentPrice: 110.25,
                        category: 'TW Stock'
                    },
                    description: 'å®Œæ•´çš„è‚¡ç¥¨è³‡æ–™'
                },
                {
                    symbol: '00921',
                    stockData: {
                        name: '00921',  // åç¨±ç­‰æ–¼ä»£è™Ÿ
                        currentPrice: 0,
                        category: 'TW Stock'
                    },
                    description: 'åç¨±ç­‰æ–¼ä»£è™Ÿï¼Œç¾åƒ¹ç‚º0'
                },
                {
                    symbol: '00921',
                    stockData: {
                        name: 'å…†è±é¾é ­ç­‰æ¬Šé‡',
                        currentPrice: 18.50,
                        category: 'TW Stock'
                    },
                    description: 'å®Œæ•´çš„ 00921 è³‡æ–™'
                },
                {
                    symbol: 'TEST01',
                    stockData: {
                        name: 'è‡ªè¨‚ (TEST01)',
                        currentPrice: 0,
                        category: 'æœªçŸ¥åˆ†é¡'
                    },
                    description: 'è‡ªè¨‚è‚¡ç¥¨ï¼Œåç¨±åŒ…å«"è‡ªè¨‚"'
                },
                {
                    symbol: 'TEST02',
                    stockData: {
                        name: 'è‚¡ç¥¨ TEST02',
                        currentPrice: 50.0,
                        category: 'TW Stock'
                    },
                    description: 'åç¨±åŒ…å«"è‚¡ç¥¨"å­—æ¨£'
                },
                {
                    symbol: 'MISSING',
                    stockData: null,
                    description: 'æ²’æœ‰è‚¡ç¥¨è³‡æ–™'
                }
            ];

            let html = '<div class="title">ğŸ§ª æª¢æ¸¬é‚è¼¯æ¸¬è©¦çµæœ</div>';

            testCases.forEach((testCase, index) => {
                const isIncomplete = isIncompleteStock(testCase.symbol, testCase.stockData);
                const cssClass = isIncomplete ? 'incomplete' : 'complete';
                const status = isIncomplete ? 'âŒ ä¸å®Œæ•´' : 'âœ… å®Œæ•´';
                
                html += `
                    <div class="test-case ${cssClass}">
                        <div class="title">æ¸¬è©¦ ${index + 1}: ${testCase.symbol}</div>
                        <div>æè¿°: ${testCase.description}</div>
                        <div class="code">
                            stockData: ${JSON.stringify(testCase.stockData, null, 2)}
                        </div>
                        <div><strong>æª¢æ¸¬çµæœ: ${status}</strong></div>
                    </div>
                `;
            });

            // ç‰¹åˆ¥æ¸¬è©¦ 00921 çš„æƒ…æ³
            html += `
                <div class="test-case incomplete">
                    <div class="title">ğŸ¯ é‡é»æ¸¬è©¦: warehouse.md ä¸­çš„ 00921</div>
                    <div>ç•¶å‰ç‹€æ³: warehouse.md ä¸­åªæœ‰ "00921   222"</div>
                    <div>è§£æçµæœ: name = "00921", currentPrice = undefined</div>
                    <div>æª¢æ¸¬æ¢ä»¶:</div>
                    <div class="code">
                        !stockData: false
                        !stockData.currentPrice: true âœ“
                        stockData.currentPrice <= 0: N/A
                        stockData.name === symbol: true âœ“
                        stockData.name.includes('è‡ªè¨‚'): false
                        stockData.name.includes('è‚¡ç¥¨'): false
                    </div>
                    <div><strong>çµæœ: âŒ æ‡‰è©²è¢«æª¢æ¸¬ç‚ºä¸å®Œæ•´</strong></div>
                </div>
            `;

            resultsDiv.innerHTML = html;
        };

        window.clearResults = () => {
            document.getElementById('results').innerHTML = '';
        };

        // è‡ªå‹•åŸ·è¡Œæ¸¬è©¦
        setTimeout(testDetectionLogic, 1000);
    </script>
</body>
</html>
