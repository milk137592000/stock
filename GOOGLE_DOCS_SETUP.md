# 📄 Google Docs 集成設定指南

## 🎯 功能說明

這個功能可以將您的 `advice.md` 和 `warehouse.md` 文件自動同步到 Google Docs，讓您可以：

- 📱 在手機上隨時查看投資組合和 AI 建議
- 🔗 與他人分享投資數據
- 📝 保持原始 markdown 格式的可讀性
- 💾 雲端備份重要數據
- 🔄 自動格式化和整理數據
- 💬 支援評論和協作功能

## 🚀 設定步驟

### 步驟 1: 創建 Google Docs

1. 前往 [Google Docs](https://docs.google.com)
2. 創建第一個文件：
   - 點擊「建立新的文件」
   - 將文件重新命名為「投資組合持股明細」
3. 創建第二個文件：
   - 再次點擊「建立新的文件」
   - 將文件重新命名為「AI投資建議記錄」

### 步驟 2: 獲取 Document ID

1. 在每個 Google Docs 文件中，查看瀏覽器網址列
2. 複製 URL 中的 Document ID：
   ```
   https://docs.google.com/document/d/[這裡是您的DOCUMENT_ID]/edit
   ```
3. 例如：`1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms`
4. 分別記錄兩個文件的 ID：
   - 投資組合文件 ID
   - AI建議文件 ID

### 步驟 3: 設定 Google Cloud Console

1. 前往 [Google Cloud Console](https://console.cloud.google.com/)
2. 如果是第一次使用，需要：
   - 同意服務條款
   - 選擇國家/地區
3. 創建新專案：
   - 點擊頂部的專案選擇器
   - 點擊「新增專案」
   - 輸入專案名稱（例如：「投資管理系統」）
   - 點擊「建立」

### 步驟 4: 啟用 Google Docs API

1. 在 Google Cloud Console 中，確保選擇了正確的專案
2. 在左側選單中，點擊「API 和服務」→「程式庫」
3. 搜尋「Google Docs API」
4. 點擊「Google Docs API」
5. 點擊「啟用」

### 步驟 5: 創建 API 金鑰

1. 在左側選單中，點擊「API 和服務」→「憑證」
2. 點擊「+ 建立憑證」→「API 金鑰」
3. 複製生成的 API 金鑰（類似：`AIzaSyBnVvzrN8lGKaOp1cEhQv2UwBdXYZ123abc`）
4. 點擊「限制金鑰」來提高安全性：
   - 在「API 限制」中選擇「限制金鑰」
   - 選擇「Google Docs API」
   - 點擊「儲存」

### 步驟 6: 設定文件權限

1. 回到您的兩個 Google Docs 文件
2. 在每個文件中點擊右上角的「共用」按鈕
3. 在「一般存取權」中選擇：
   - 「知道連結的使用者」→「檢視者」（推薦）
   - 或「任何人」→「檢視者」（如果您想公開分享）
4. 點擊「完成」
5. 對兩個文件都重複此步驟

### 步驟 7: 在應用程式中配置

1. 在投資顧問應用程式中，找到「📄 Google Docs 同步」區塊
2. 點擊「⚙️ 設定」按鈕
3. 填入以下資訊：
   - **投資組合 Document ID**: 投資組合文件的 ID
   - **AI建議 Document ID**: AI建議文件的 ID
   - **API Key**: 從步驟 5 獲得的 API 金鑰
4. 點擊「💾 保存配置」

## 🔄 使用方式

### 同步數據
1. 確保配置完成（顯示「✅ 已配置」）
2. 點擊「📤 同步到 Google Sheets」
3. 等待同步完成
4. 點擊「📋 開啟試算表」查看結果

### 查看數據
- **投資組合工作表**: 顯示您當前的股票持倉
- **AI建議記錄工作表**: 顯示所有 AI 模型的投資建議歷史

## 📋 數據格式

### 投資組合工作表
| 股票代號 | 持股數量 | 股票名稱 | 現價 | 漲跌 | 漲跌% | 更新時間 |
|---------|---------|---------|------|------|-------|----------|
| 006208  | 289     | 富邦台50 | 110.70 | 0.00 | 0.00% | 2025-06-17... |

### AI建議記錄工作表
| 日期 | AI模型 | 市場展望 | 投資金額 | 分配金額 | 建議內容 |
|------|--------|----------|----------|----------|----------|
| 2025/06/17 | Meta | 目前台灣股市趨勢... | 8000 | 260465 | 📈 台積電: 買入... |

## 🛡️ 安全注意事項

1. **API 金鑰安全**：
   - 不要在公開場所分享您的 API 金鑰
   - 定期檢查 API 使用量
   - 如有疑慮可重新生成金鑰

2. **工作表權限**：
   - 建議設為「知道連結的使用者」而非「公開」
   - 定期檢查誰有存取權限

3. **數據隱私**：
   - Google Sheets 會儲存您的投資數據
   - 請確保您同意將數據存放在 Google 雲端

## 🔧 故障排除

### 問題 1: 同步失敗
**可能原因**：
- API 金鑰無效或過期
- Spreadsheet ID 錯誤
- 工作表名稱不匹配
- 網路連線問題

**解決方案**：
1. 檢查 API 金鑰是否正確
2. 確認 Spreadsheet ID 是否正確
3. 檢查工作表名稱是否完全匹配
4. 確保網路連線正常

### 問題 2: 無法開啟試算表
**可能原因**：
- Spreadsheet ID 錯誤
- 工作表權限設定問題

**解決方案**：
1. 重新檢查 Spreadsheet ID
2. 確認工作表權限設為「知道連結的使用者」

### 問題 3: API 配額超限
**可能原因**：
- Google Sheets API 有每日使用限制

**解決方案**：
1. 等待 24 小時後重試
2. 考慮升級到付費方案（如需要）

## 📞 技術支援

如果遇到問題，請檢查：
1. 瀏覽器開發者工具的 Console 錯誤訊息
2. Google Cloud Console 中的 API 使用情況
3. Google Sheets 的權限設定

---

**🎉 設定完成後，您就可以隨時在 Google Sheets 中查看最新的投資數據了！**
